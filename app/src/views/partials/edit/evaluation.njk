{% macro option(input, val, name) %}<option value='{{val}}'{% if input == val %} selected{% endif %}>{{name}}</option>{% endmacro %}

<div class='evaluation_container' id='evaluation_container_{{evaluationContext}}'>
    <div>
        <label for='evaluation_type_{{evaluationKey}}'>Type</label>
        <select name='evaluation{{evaluationContext}}[type]' id='evaluation_type_{{evaluationKey}}'>
            {{ option(evaluation.type, 'high', 'High') }}
            {{ option(evaluation.type, 'low', 'Low') }}
            {{ option(evaluation.type, 'point_low', 'Point Low') }}
            {{ option(evaluation.type, 'point_high', 'Point High') }}
            {{ option(evaluation.type, 'badugi', 'Badugi') }}
            {{ option(evaluation.type, 'split', 'Split') }}
        </select>
    </div>
    <div id='evaluation_exclusivity_{{evaluationKey}}_split'>
        <ul>

        </ul>
    </div>
    <div id='evaluation_exclusivity_{{evaluationKey}}_scoring'>
        <div>
            <label for='evaluation_exclusivity_{{evaluationKey}}'>Exclusivity</label>
            <select name='evaluation{{evaluationContext}}[exclusivity]' id='evaluation_exclusivity_{{evaluationKey}}'>
                {{ option(evaluation.exclusivity, 'any', 'Any player cards') }}
                {{ option(evaluation.exclusivity, 'all', 'All player cards') }}
                {{ option(evaluation.exclusivity, 'one', 'Exactly one player card') }}
                {{ option(evaluation.exclusivity, 'two', 'Exactly two player cards') }}
                {{ option(evaluation.exclusivity, 'three', 'Exactly three player cards') }}
                {{ option(evaluation.exclusivity, 'four', 'Exactly four player cards') }}
                {{ option(evaluation.exclusivity, 'five', 'Exactly five player cards') }}
                {{ option(evaluation.exclusivity, 'six', 'Exactly six player cards') }}
                {{ option(evaluation.exclusivity, 'seven', 'Exactly seven player cards') }}
            </select>
        </div>
        <div>
            <label for='evaluation_qualifier_{{evaluationKey}}_ace'>Ace Orientation</label>
            <select name='evaluation{{evaluationContext}}[ace]' id='evaluation_qualifier_{{evaluationKey}}_ace'>
                {{ option(evaluation.ace_position, 'both', 'Both') }}
                {{ option(evaluation.ace_position, 'low', 'Low only') }}
                {{ option(evaluation.ace_position, 'high', 'High only') }}
            </select>
        </div>
        <div>
            <label for='evaluation_formal_name{{evaluationKey}}'>Formal name</label>
            <input value='{{evaluation.html.formal_name}}' placeholder='5-Card Draw' type='text' id='evaluation_formal_name{{evaluationKey}}' name='evaluation{{evaluationContext}}[formal_name]' />
            (Optional: a game name or description for how to evaluate this hand)
        </div>
        <div>
            <label for='evaluation_player_hand_size{{evaluationKey}}'>Player hand size</label>
            <input value='{{evaluation.player_hand_size}}' pattern='[1-9]?' placeholder='4' type='text' id='evaluation_player_hand_size{{evaluationKey}}' name='evaluation{{evaluationContext}}[player_hand_size]' />
            (Optional: this evaluation context is associated with a player hand of this size)
        </div>
        <div>
            <label for='evaluation_qualifier_enabled_{{evaluationKey}}'>Qualifier</label>
            <input type='checkbox' id='evaluation_qualifier_enabled_{{evaluationKey}}'{% if evaluation.has_qualifier %} checked{% endif %} />
        </div>
        <div id='evaluation_qualifier_container_{{evaluationKey}}'>
            <label for='evaluation_qualifier_{{evaluationKey}}'>Qualifier type</label>
            <select name='evaluation{{evaluationContext}}[qualifier][type]' id='evaluation_qualifier_{{evaluationKey}}'>
                {{ option(evaluation.qualifier.type, 'none', 'Both') }}
                {{ option(evaluation.qualifier.type, 'lower_rank', 'Lower or equal rank (≤)') }}
                {{ option(evaluation.qualifier.type, 'higher_rank', 'Higher or equal rank (≥)') }}
                {{ option(evaluation.qualifier.type, 'lower_hand', 'Lower or equal hand (≤)') }}
                {{ option(evaluation.qualifier.type, 'higher_hand', 'Higher or equal hand (≥)') }}
            </select>

            <div id='evaluation_qualifier_{{evaluationKey}}_ranklist_container'>
                <label for='evaluation_qualifier_{{evaluationKey}}_rank'>Qualifying rank</label>
                <select name='evaluation{{evaluationContext}}[qualifier][rank]' id='evaluation_qualifier_{{evaluationKey}}_rank'>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                    <option>6</option>
                    <option>7</option>
                    <option>8</option>
                    <option>9</option>
                    <option>T</option>
                    <option>J</option>
                    <option>Q</option>
                    <option>K</option>
                </select>
            </div>
            <div id='evaluation_qualifier_{{evaluationKey}}_hand_container'>
                <div>
                    <label for='evaluation_qualifier_{{evaluationKey}}_hand'>Qualifying hand</label>
                    <select name='evaluation{{evaluationContext}}[hand]' id='evaluation_qualifier_{{evaluationKey}}_hand'>
                        <option value='high'>High</option>
                        <option value='pair'>Pair</option>
                        <option value='two_pair'>Two pair</option>
                        <option value='three_of_a_kind'>Three of a kind</option>
                        <option value='straight'>Straight</option>
                        <option value='flush'>Flush</option>
                        <option value='full_house'>Full house</option>
                        <option value='four_of_a_kind'>Four of a kind</option>
                        <option value='straight_flush'>Straight flush</option>
                        <option value='royal_flush'>Royal flush</option>
                    </select>
                </div>
                <div>
                    <label for=''>Specific value</label>
                    <input type='text' placeholder='99' pattern='[1-9|A|T|J|Q|K]{1,5}' />
                    <span>(optional; Accepted characters: A23456789TJQK)</span>
                </div>
            </div>
        </div>
        <div>
            <label for='evaluation_invalidationhands_enabled_{{evaluationKey}}'>Invalidation Hands</label>
            <input type='checkbox' id='evaluation_invalidationhands_enabled_{{evaluationKey}}' />
        </div>
        <div id='evaluation_invalidationhands_container_{{evaluationKey}}'>
            <ol id='evaluation{{evaluationKey}}_invalidation_list'></ol>
            <select id='evaluation_qualifier_{{evaluationKey}}_invalidation'>
                <option value='high'>High</option>
                <option value='pair'>Pair</option>
                <option value='two_pair'>Two pair</option>
                <option value='three_of_a_kind'>Three of a kind</option>
                <option value='straight'>Straight</option>
                <option value='flush'>Flush</option>
                <option value='full_house'>Full house</option>
                <option value='four_of_a_kind'>Four of a kind</option>
                <option value='straight_flush'>Straight flush</option>
                <option value='royal_flush'>Royal flush</option>
            </select>
            <a href='#' class='add button' onclick='appendInvalidationHand({{evaluationKey}});'>Append hand</a>
        </div>

        <div>
            <label>Bug Completion Hands</label>
            <ol></ol>
        </div>
    </div>
</div>
<script>
    $('#evaluation_type_{{evaluationKey}}').change(function () { didChangeEvaluationType('{{game.sanitized_name}}', '{{evaluationKey}}'); });
    $('#evaluation_qualifier_enabled_{{evaluationKey}}').change(function () { didChangeQualifierEnabled('{{evaluationKey}}'); });
    $('#evaluation_invalidationhands_enabled_{{evaluationKey}}').change(function () { didChangeValidationHandsEnabled('{{evaluationKey}}'); });

    didChangeEvaluationType('{{game.sanitized_name}}', '{{evaluationKey}}');
    didChangeQualifierEnabled('{{evaluationKey}}');
    didChangeValidationHandsEnabled('{{evaluationKey}}');
</script>
